(()=>{var e="is-selected";function t(e){for(;e.firstChild;)e.removeChild(e.firstChild);}function i(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"beforeend";e.insertAdjacentHTML(i,t);}function o(e,t){for(var i=null;e&&e!==this&&e&&e.matches;){if(e.matches(t)){i=e;break}e=e.parentNode;}return i}var s="dzs-chip-selector--autocompletelist--is-placeholder-visible";function n(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o);}}function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}console.log("ceva2 2 3 4  33 4");var c=function(){function c(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),r(this,"feedSource","form"),r(this,"autoCompleteOptions",[]),r(this,"persistentOptions",[]),r(this,"inputForm_currentQueryString",""),e&&(this.chipSelectorOptions=Object.assign({placeholderNoItemsFound:"No items found",middlewareFilterResults:null},t),console.log("this.chipSelectorOptions - ",this.chipSelectorOptions),this.$elem_=e,e.selfInstance=this,this.placeholderNoItemsFound=this.chipSelectorOptions.placeholderNoItemsFound,e.isDzsChipsInited||this.initClass());}var l,u,a;return l=c,u=[{key:"initClass",value:function(){this.$elem_.isDzsChipsInited=!0,this.$elem_.classList.add("dzs-chip-selector--is-inited"),this.initStructure(),this.initAfterStructure();}},{key:"initStructure",value:function(){console.log("initStructure"),this.$elem_.querySelector(".dzs-chip-selector--container")||i(this.$elem_,'<div class="dzs-chip-selector--container">\n          <div class="dzs-chip-selector--form-field">\n            <div class="dzs-chip-selector--chip-list">\n              <ul class="dzs-chip-selector--chip-list-wrapper">\n\n              </ul>\n            </div>\n            <label class="dzs-chip-selector--input-new-element--label">\n              <input placeholder="New fruit..." class="dzs-chip-selector--input-new-element"\n                     autocomplete="off"\n                     role="combobox" aria-autocomplete="list" aria-expanded="false"\n                     aria-haspopup="listbox"\n                     aria-owns="mat-autocomplete-1">\n            </label>\n          </div>\n        </div>'),this.$elem_.querySelector(".dzs-chip-selector--autocompletelist")||i(this.$elem_,'<div class="dzs-chip-selector--autocompletelist">\n          <div class="dzs-chip-selector--autocompletelist--inner">\n            <div class="dzs-chip-selector--autocompletelist--placeholder">No items found</div>\n            <ul class="dzs-chip-selector--autocompletelist--items">\n            </ul>\n          </div>\n        </div>');}},{key:"reinit",value:function(){var e=this.$elem_.querySelector(".dzs-chip-selector--form");e?(this.feedSource="form",this.chipSelectorOptions.persistentOptions=null,this.getOptionsFromForm(e)):this.$elem_.getAttribute("data-persistentOptions")&&this.readAttrForPersistentOptions(),this.chipSelectorOptions.persistentOptions&&(this.feedSource="options",this.persistentOptions=this.chipSelectorOptions.persistentOptions,this.autoCompleteOptions=this.chipSelectorOptions.persistentOptions),this.createListFromOptions(),this.updateChipsFromOptions();}},{key:"readAttrForPersistentOptions",value:function(){var e=this.$elem_.getAttribute("data-persistentOptions");this.chipSelectorOptions.persistentOptions=JSON.parse(e);}},{key:"getOptionsFromForm",value:function(e){var t=this;e.childNodes.forEach((function(e){if(e.nodeName.toLowerCase()==="LABEL".toLowerCase()){console.log(e,e.innerHTML);var i=e.querySelector("input"),o=e.innerHTML.replace(/<input.*?>/g,"");console.log(i,o);var s={htmlContent:o,value:i.value,currentStatus:i.checked?"checked":"unchecked"};t.persistentOptions.push(s),t.autoCompleteOptions.push(s);}}));}},{key:"initAfterStructure",value:function(){var t=this;function i(e){var i=t.$inputNewElement_;if("keyup"===e.type){if(console.log("selfInstance.inputForm_currentQueryString - ",t.inputForm_currentQueryString,"value - ",i.value),t.inputForm_currentQueryString===i.value)return;t.inputForm_currentQueryString=i.value,console.log("keeeyup",t.inputForm_currentQueryString),t.autoCompleteFilterResults(t.inputForm_currentQueryString);}"focus"===e.type&&t.onInputAreaFocus(),"blur"===e.type&&t.onInputAreaFocus(!1);}t.$inputNewElement_=this.$elem_.querySelector(".dzs-chip-selector--input-new-element"),t.$autoCompleteList=this.$elem_.querySelector(".dzs-chip-selector--autocompletelist"),t.$form=this.$elem_.querySelector(".dzs-chip-selector--form"),this.$inputNewElement_.addEventListener("focus",i),this.$inputNewElement_.addEventListener("blur",i),this.$inputNewElement_.addEventListener("keyup",i),this.$autoCompleteList.addEventListener("click",(function(i){if("click"===i.type){console.log("click e.target",i.target);var s=o(i.target,".dzs-chip-selector--autocompletelist--items--item");console.log("target - ",s);var n=s.getAttribute("data-value"),r=c.getOptionFromValue(t.autoCompleteOptions,n),l=c.getOptionFromValue(t.persistentOptions,n);void 0===l&&(console.log("undefined"),console.log("target - ",s),l={htmlContent:s.innerHTML,value:s.getAttribute("data-value"),currentStatus:"unchecked"},t.persistentOptions.push(l)),s.classList.contains(e)?(r.currentStatus="unchecked",l.currentStatus="unchecked"):(r.currentStatus="checked",l.currentStatus="checked"),console.log(t.autoCompleteOptions),t.updateListFromOptions(),t.updateFormFromOptions(),t.updateChipsFromOptions(),t.$inputNewElement_.value="",t.$inputNewElement_.dispatchEvent(new Event("keyup")),t.$inputNewElement_.dispatchEvent(new Event("change"));}})),this.$elem_.querySelector(".dzs-chip-selector--chip-list-wrapper").addEventListener("click",(function(e){if("click"===e.type){var i=o(e.target,".dzs-chip-selector--item--remove");if(i){var s=i.parentNode;console.log(s);var n=s.getAttribute("data-value"),r=c.getOptionFromValue(t.autoCompleteOptions,n),l=c.getOptionFromValue(t.persistentOptions,n);r.currentStatus="unchecked",l.currentStatus="unchecked",t.updateListFromOptions(),t.updateChipsFromOptions(),t.updateFormFromOptions();}}})),this.reinit();}},{key:"onInputAreaFocus",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];console.log("this.$inputNewElement_ - ",this.$inputNewElement_,this.$elem_);var t=this.$inputNewElement_.getBoundingClientRect().x-this.$elem_.getBoundingClientRect().x;console.log({autocompleteListX:t},this.$elem_.getBoundingClientRect(),this.$inputNewElement_.getBoundingClientRect().x,this.$elem_.getBoundingClientRect().x),e?(this.$autoCompleteList.style.left=t+"px",this.$elem_.classList.add("dzs-chip-selector--is-new-element-focused")):this.$elem_.classList.remove("dzs-chip-selector--is-new-element-focused");}},{key:"updateListFromOptions",value:function(){var t=this,i=this.$autoCompleteList.querySelector(".dzs-chip-selector--autocompletelist--items");console.log("updateListFromOptions-- $ulItems dzs-chip-selector--autocompletelist--items - ",i),i.childNodes.forEach((function(i){console.log(i);var o=i.getAttribute("data-value"),s=c.getOptionFromValue(t.persistentOptions,o);console.log("updateListFromOptions--",{persistentOption:s}),void 0!==s&&("unchecked"===s.currentStatus&&i.classList.remove(e),"checked"===s.currentStatus&&i.classList.add(e));}));}},{key:"updateFormFromOptions",value:function(){var e=this;"form"===this.feedSource&&t(e.$form),this.chipSelectorOptions.onUpdateFunction&&this.chipSelectorOptions.onUpdateFunction(this.persistentOptions),"form"===this.feedSource&&this.persistentOptions.forEach((function(t){i(e.$form,'<label><input type="checkbox" '.concat("checked"===t.currentStatus?"checked":"",' name="subject[]" value="').concat(t.value,'">').concat(t.htmlContent,"</label>"));}));}},{key:"updateChipsFromOptions",value:function(){var e=this.$elem_.querySelector(".dzs-chip-selector--chip-list-wrapper");t(e),this.persistentOptions.forEach((function(t){"checked"===t.currentStatus&&i(e,'<li data-value="'.concat(t.value,'" class="dzs-chip-selector--item">\n<div class="dzs-chip-selector--item--content">').concat(t.htmlContent,'</div>\n<button _ngcontent-mua-c151="" matchipremove="" class="dzs-chip-selector--item--remove"  type="button">\n  <figure>x</figure>\n</button>\n</li>'));}));}},{key:"createListFromOptions",value:function(){console.log("createListFromOptions-- "," this - ",this);var o=this.$autoCompleteList.querySelector(".dzs-chip-selector--autocompletelist--items");t(o),this.autoCompleteOptions.forEach((function(t){i(o,'<li class="dzs-chip-selector--autocompletelist--items--item '.concat("checked"===t.currentStatus?e:"",'" data-value="').concat(t.value,'">').concat(t.htmlContent,"</li>"));}));}},{key:"getAutocompleteItemDomFromValue",value:function(e){this.$autoCompleteList.querySelectorAll(".dzs-chip-selector--autocompletelist--items--item").forEach((function(t){if(t.getAttribute("data-value")===e)return t}));}},{key:"autoCompleteFilterResults",value:function(e){var t=this;function i(t){t.autoCompleteOptions.forEach((function(e){}));var i=t.$autoCompleteList.querySelectorAll(".dzs-chip-selector--autocompletelist--items--item");e=e.toLowerCase();var o=0;i.forEach((function(i){""===t.inputForm_currentQueryString||i.textContent.toLowerCase().indexOf(e)>-1?(i.classList.remove("is-hidden"),o++):i.classList.add("is-hidden");})),0===o?t.$autoCompleteList.classList.add(s):t.$autoCompleteList.classList.remove(s);}console.log("stringSequence - ",e,"this.inputForm_currentQueryString -",this.inputForm_currentQueryString),e==this.inputForm_currentQueryString&&(this.chipSelectorOptions.middlewareFilterResults?this.chipSelectorOptions.middlewareFilterResults(this,e).then((function(){i(t);})).catch((function(e){console.log("error - "),console.log(e);})):i(this));}}],a=[{key:"getOptionFromValue",value:function(e,t){return e.filter((function(e){return e.value===t}))[0]}}],u&&n(l.prototype,u),a&&n(l,a),Object.defineProperty(l,"prototype",{writable:!1}),c}();window.dzs_initDzsChipSelector=function(e,t){new c(e,t);};})();
