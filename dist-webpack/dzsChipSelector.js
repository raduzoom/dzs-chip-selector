(()=>{"use strict";var e={669:(e,t,i)=>{i.d(t,{Q:()=>n});var n="dzs-chip-selector--autocompletelist--is-placeholder-visible"}},t={};function i(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,i),r.exports}i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var n={};(()=>{i.d(n,{o:()=>C});var e,t="dzs-chip-selector",o="is-selected",r="dzs-chip-selector--autocompletelist--items--item",s="dzs-chip-selector--overflow-tooltip";function l(e){if(e&&e.firstChild)for(;e.firstChild;)e.removeChild(e.firstChild)}function c(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"beforeend";e.insertAdjacentHTML(i,t)}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"min-width",i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e){var n=globalThis.getComputedStyle(e,null).getPropertyValue(t);return i?parseFloat(n):n}return""}function p(e,t){for(var i=null;e&&e!==this&&e&&e.matches;){if(e.matches(t)){i=e;break}e=e.parentNode}return i}!function(e){e.CHECKED="checked",e.UNCHECKED="unchecked"}(e||(e={}));var u=i(669),h={placeholderNoItemsFound:"No items found",inputPlaceholderText:"Filter results...",middlewareFilterResults:null,viewSkin:"default",viewIsWrapping:!0};function d(t){var i,n;function s(e){var i=t.$inputNewElement_;if("keyup"===e.type){if(t.inputForm_currentQueryString===i.value)return;t.inputForm_currentQueryString=i.value,t.autoCompleteFilterResults(t.inputForm_currentQueryString)}"focus"===e.type&&t.onInputAreaFocus(),"blur"===e.type&&t.onInputAreaFocus(!1)}t.$inputNewElement_.addEventListener("focus",s),t.$inputNewElement_.addEventListener("blur",s),t.$inputNewElement_.addEventListener("keyup",s),t.$autoCompleteList.addEventListener("click",(function(i){if("click"===i.type){var n=p(i.target,"."+r),s=null,l=String(null==n?void 0:n.getAttribute("data-value"));if(l){var c=C.getOptionFromValue(t.autoCompleteOptions,l),a=C.getOptionFromValue(t.persistentOptions,l);void 0===a&&(a={htmlContent:null==n?void 0:n.innerHTML,value:null==n?void 0:n.getAttribute("data-value"),currentStatus:e.UNCHECKED},t.persistentOptions.push(a)),null!=n&&n.classList.contains(o)?(c.currentStatus=e.UNCHECKED,a.currentStatus=e.UNCHECKED):((s=t.persistentOptions.findIndex((function(e){return e.value===a.value})))<t.persistentOptions.length-1&&t.persistentOptions.push(t.persistentOptions.splice(s,1)[0]),c.currentStatus=e.CHECKED,a.currentStatus=e.CHECKED),t.updateListFromOptions(),t.updateFormFromOptions(),t.updateChipsFromOptions(),t.$inputNewElement_.value="",t.$inputNewElement_.dispatchEvent(new Event("keyup")),t.$inputNewElement_.dispatchEvent(new Event("change"))}}})),null===(i=t.$elem_)||void 0===i||null===(n=i.querySelector(".dzs-chip-selector--chip-list-wrapper"))||void 0===n||n.addEventListener("click",(function(i){if("click"===i.type){var n=p(i.target,".dzs-chip-selector--item--remove");if(n){var o=n.parentNode,r=String(o.getAttribute("data-value")),s=C.getOptionFromValue(t.autoCompleteOptions,r),l=C.getOptionFromValue(t.persistentOptions,r);s?s.currentStatus=e.UNCHECKED:console.log("[targetOption] targetOption not existing",t.autoCompleteOptions),l.currentStatus=e.UNCHECKED,t.updateListFromOptions(),t.updateChipsFromOptions(),t.updateFormFromOptions()}}})),t.chipSelectorOptions.viewIsWrapping||new ResizeObserver((function(e){t.viewCheckIfNeedsWrapping(t),console.log("Size changed",e)})).observe(t.$elem_)}function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function v(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function f(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?v(Object(i),!0).forEach((function(t){S(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):v(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,g(n.key),n)}}function S(e,t,i){return(t=g(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function g(e){var t=function(e,t){if("object"!==m(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,"string");if("object"!==m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===m(t)?t:String(t)}var C=function(){function i(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];O(this,i),S(this,"styleIsSkinSet",!1),S(this,"feedSource","form"),S(this,"autoCompleteOptions",[]),S(this,"persistentOptions",[]),S(this,"inputForm_currentQueryString",""),e&&(this.chipSelectorOptions=Object.assign(f({},h),t),this.$elem_=e,e.selfInstance=this,this.placeholderNoItemsFound=String(this.chipSelectorOptions.placeholderNoItemsFound),e.isDzsChipsInited||n&&this.initClass())}var n,p,m;return n=i,p=[{key:"initClass",value:function(){var e;(e=this).styleIsSkinSet=!1,e.$elem_.isDzsChipsInited=!0,function(e){for(var t,i=/dzs-chip-selector--skin-(.*?)( |$)/g,n=[];null!==(t=i.exec(e));)n.push(t);return n}(e.$elem_.className).length&&(e.styleIsSkinSet=!0),e.$elem_.classList.add(t+"--is-inited"),e.chipSelectorOptions.viewIsWrapping||e.$elem_.classList.add(t+"--view-one-line"),e.styleIsSkinSet||e.$elem_.classList.add(t+"--skin-".concat(e.chipSelectorOptions.viewSkin)),function(e){if(!e.$elem_.querySelector(".dzs-chip-selector--container")){var t='<div class="dzs-chip-selector--overflow-placeholder"><span>...</span>\n  <span class="'.concat(s,'">This is the tooltip text</span></div>'),i='<label class="dzs-chip-selector--input-new-element--label">\n              <input placeholder="'.concat(e.chipSelectorOptions.inputPlaceholderText,'" class="dzs-chip-selector--input-new-element"\n                     autocomplete="off"\n                     role="combobox" aria-autocomplete="list" aria-expanded="false"\n                     aria-haspopup="listbox"\n                     aria-owns="mat-autocomplete-1">\n            </label>');c(e.$elem_,'<div class="dzs-chip-selector--container">\n          <div class="dzs-chip-selector--form-field">\n            '.concat('<div class="dzs-chip-selector--chip-list">\n              <ul class="dzs-chip-selector--chip-list-wrapper">\n\n              </ul>\n            </div>',"\n            ").concat(e.chipSelectorOptions.viewIsWrapping?"":t,"\n            ").concat(i,"\n          </div>\n        </div>"))}e.$elem_.querySelector(".dzs-chip-selector--autocompletelist")||c(e.$elem_,'<div class="dzs-chip-selector--autocompletelist">\n          <div class="dzs-chip-selector--autocompletelist--inner">\n            <div class="dzs-chip-selector--autocompletelist--placeholder">No items found</div>\n            <ul class="dzs-chip-selector--autocompletelist--items">\n            </ul>\n          </div>\n        </div>')}(this),this.initAfterStructure()}},{key:"reinit",value:function(){var e=this.$elem_.querySelector(".dzs-chip-selector--form");e?(this.feedSource="form",this.chipSelectorOptions.persistentOptions=null,this.getOptionsFromForm(e)):this.$elem_.getAttribute("data-persistentOptions")&&this.readAttrForPersistentOptions(),this.chipSelectorOptions.persistentOptions&&(this.feedSource="options",this.persistentOptions=this.chipSelectorOptions.persistentOptions,this.autoCompleteOptions=this.chipSelectorOptions.persistentOptions),this.createListFromOptions(),this.updateChipsFromOptions()}},{key:"readAttrForPersistentOptions",value:function(){var e=this.$elem_.getAttribute("data-persistentOptions");this.chipSelectorOptions.persistentOptions=JSON.parse(String(e))}},{key:"getOptionsFromForm",value:function(t){var i=this;t.childNodes.forEach((function(t){if(t.nodeName.toLowerCase()==="LABEL".toLowerCase()){var n=t.querySelector("input"),o={htmlContent:t.innerHTML.replace(/<input.*?>/g,""),value:String(null==n?void 0:n.value),currentStatus:null!=n&&n.checked?e.CHECKED:e.UNCHECKED};i.persistentOptions.push(o),i.autoCompleteOptions.push(o)}}))}},{key:"initAfterStructure",value:function(){var e=this;e.$inputNewElement_=this.$elem_.querySelector(".dzs-chip-selector--input-new-element"),e.$autoCompleteList=this.$elem_.querySelector(".dzs-chip-selector--autocompletelist"),e.$form=this.$elem_.querySelector(".dzs-chip-selector--form"),d(this),this.reinit()}},{key:"onInputAreaFocus",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=this.$inputNewElement_.getBoundingClientRect().x-this.$elem_.getBoundingClientRect().x;e?(this.$autoCompleteList.style.left=i+"px",this.$elem_.classList.add(t+"--is-new-element-focused")):this.$elem_.classList.remove(t+"--is-new-element-focused")}},{key:"updateListFromOptions",value:function(){var t=this,n=this.$autoCompleteList.querySelector(".dzs-chip-selector--autocompletelist--items");null==n||n.childNodes.forEach((function(n){var r=String(n.getAttribute("data-value")),s=i.getOptionFromValue(t.persistentOptions,r);void 0!==s&&(s.currentStatus===e.UNCHECKED&&n.classList.remove(o),s.currentStatus===e.CHECKED&&n.classList.add(o))}))}},{key:"updateFormFromOptions",value:function(){var t=this;"form"===this.feedSource&&l(t.$form),this.$elem_.webComponent&&this.$elem_.webComponent.onUpdate&&(this.chipSelectorOptions.onUpdateFunction=this.$elem_.webComponent.onUpdate),this.chipSelectorOptions.onUpdateFunction&&this.chipSelectorOptions.onUpdateFunction(this.persistentOptions),"form"===this.feedSource&&this.persistentOptions.forEach((function(i){c(t.$form,'<label><input type="checkbox" '.concat(i.currentStatus===e.CHECKED?e.CHECKED:"",' name="subject[]" value="').concat(i.value,'">').concat(i.htmlContent,"</label>"))}))}},{key:"updateChipsFromOptions",value:function(){var t=this,i=t.$elem_.querySelector(".dzs-chip-selector--chip-list-wrapper");l(i);var n="";this.persistentOptions.forEach((function(o){o.currentStatus===e.CHECKED&&(c(i,function(e){return'<li data-value="'.concat(e.value,'" class="dzs-chip-selector--item">\n<div class="dzs-chip-selector--item--content">').concat(e.htmlContent,'</div>\n<button _ngcontent-mua-c151="" matchipremove="" class="dzs-chip-selector--item--remove"  type="button">\n  <figure>x</figure>\n</button>\n</li>')}(o)),t.chipSelectorOptions.viewIsWrapping||(n&&(n+=", "),n+=o.htmlContent))})),t.chipSelectorOptions.viewIsWrapping||(this.viewCheckIfNeedsWrapping(this),t.$elem_.querySelector("."+s).innerHTML=n)}},{key:"viewCheckIfNeedsWrapping",value:function(e){var t=!1,i=0,n=a(e.$elem_.querySelector(".dzs-chip-selector--input-new-element--label"),"min-width",!0),o=a(e.$elem_.querySelector(".dzs-chip-selector--container"),"width",!0),r=0;e.chipSelectorOptions.viewIsWrapping||(i=Number(a(e.$elem_.querySelector(".dzs-chip-selector--overflow-placeholder"),"width",!0))+Number(a(e.$elem_.querySelector(".dzs-chip-selector--overflow-placeholder"),"margin-left",!0))),e.$elem_.querySelector(".dzs-chip-selector--chip-list-wrapper").childNodes.forEach((function(e){var s=e;s.style.display="",(r+=a(s,"width",!0)+3)>o-n-i?(s.style.display="none",t=!0):s.style.display=""})),t?e.$elem_.classList.add("dzs-chip-selector--is-overflowing"):e.$elem_.classList.remove("dzs-chip-selector--is-overflowing")}},{key:"createListFromOptions",value:function(){var t=this.$autoCompleteList.querySelector(".dzs-chip-selector--autocompletelist--items");l(t),this.autoCompleteOptions.forEach((function(i){c(t,'<li class="dzs-chip-selector--autocompletelist--items--item '.concat(i.currentStatus===e.CHECKED?o:"",'" data-value="').concat(i.value,'">').concat(i.htmlContent,"</li>"))}))}},{key:"getAutocompleteItemDomFromValue",value:function(e){this.$autoCompleteList.querySelectorAll("."+r).forEach((function(t){if(t.getAttribute("data-value")===e)return t}))}},{key:"autoCompleteFilterResults",value:function(e){var t=this;function i(t){t.autoCompleteOptions.forEach((function(e){}));var i=t.$autoCompleteList.querySelectorAll("."+r);e=e.toLowerCase();var n=0;i.forEach((function(i){""===t.inputForm_currentQueryString||(i.textContent||"").toLowerCase().indexOf(e)>-1?(i.classList.remove("is-hidden"),n++):i.classList.add("is-hidden")})),0===n?t.$autoCompleteList.classList.add(u.Q):t.$autoCompleteList.classList.remove(u.Q)}e==this.inputForm_currentQueryString&&(this.chipSelectorOptions.middlewareFilterResults?this.chipSelectorOptions.middlewareFilterResults(this,e).then((function(){i(t)})).catch((function(e){console.log("error - ",e)})):i(this))}}],m=[{key:"getOptionFromValue",value:function(e,t){return e.filter((function(e){return e.value===t}))[0]}}],p&&y(n.prototype,p),m&&y(n,m),Object.defineProperty(n,"prototype",{writable:!1}),i}();(globalThis||window).dzs_initDzsChipSelector=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};new C(e,t)}})()})();
//# sourceMappingURL=dzsChipSelector.js.map